═══════════════════════════════════════════════════════════════
  🍎 百果园舆情监测系统 - 5分钟快速部署指南
═══════════════════════════════════════════════════════════════

📋 服务器信息
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
  IP地址：101.201.214.42
  用户名：root
  密码：qwer.123
  端口：5000
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


🚀 方案一：自动部署（推荐）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

步骤1：安装sshpass（首次需要）

  macOS:
  brew install hudochenkov/sshpass/sshpass

  Ubuntu:
  sudo apt-get install sshpass

步骤2：运行自动部署脚本

  cd /Users/xiaoyan/Desktop/舆情/BettaFish-test
  ./云端部署.sh

步骤3：等待5-10分钟完成部署

步骤4：访问系统
  http://101.201.214.42:5000

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


🖐️ 方案二：手动部署（不需要sshpass）
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

第一步：登录服务器
───────────────────────────────────────────────────────
  在终端执行：
  ssh root@101.201.214.42

  输入密码：qwer.123


第二步：准备服务器环境
───────────────────────────────────────────────────────
  在服务器上执行以下命令（复制粘贴）：

  mkdir -p /root/baiguoyuan
  cd /root/baiguoyuan


第三步：上传项目文件
───────────────────────────────────────────────────────
  在本地【新开一个终端】执行：

  cd /Users/xiaoyan/Desktop/舆情/BettaFish-test
  tar czf baiguoyuan.tar.gz --exclude='venv' --exclude='__pycache__' --exclude='*.pyc' --exclude='.git' --exclude='logs' --exclude='*.log' --exclude='.DS_Store' .
  scp baiguoyuan.tar.gz root@101.201.214.42:/root/baiguoyuan/

  输入密码：qwer.123


第四步：解压并安装依赖
───────────────────────────────────────────────────────
  回到服务器终端，执行：

  cd /root/baiguoyuan
  tar xzf baiguoyuan.tar.gz
  rm baiguoyuan.tar.gz
  python3 -m venv venv
  source venv/bin/activate
  pip install --upgrade pip
  pip install streamlit pandas openai schedule requests beautifulsoup4 selenium


第五步：配置防火墙
───────────────────────────────────────────────────────
  在服务器上执行：

  # 如果是CentOS
  firewall-cmd --permanent --add-port=5000/tcp
  firewall-cmd --reload

  # 如果是Ubuntu
  ufw allow 5000/tcp

  ⚠️ 重要：还需要在阿里云控制台配置安全组开放5000端口！


第六步：启动服务
───────────────────────────────────────────────────────
  在服务器上执行：

  cd /root/baiguoyuan
  source venv/bin/activate
  nohup streamlit run baiguoyuan_review_app.py --server.port 5000 --server.address 0.0.0.0 --server.headless true > app.log 2>&1 &
  echo $! > app.pid
  echo "✅ 服务已启动"


第七步：验证服务
───────────────────────────────────────────────────────
  在服务器上执行：

  # 检查进程
  ps aux | grep streamlit

  # 查看日志
  tail -f app.log

  访问：http://101.201.214.42:5000

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


🔧 常用管理命令
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

停止服务：
  kill $(cat /root/baiguoyuan/app.pid)
  或
  pkill -f "streamlit run baiguoyuan_review_app.py"

启动服务：
  cd /root/baiguoyuan
  source venv/bin/activate
  nohup streamlit run baiguoyuan_review_app.py --server.port 5000 --server.address 0.0.0.0 --server.headless true > app.log 2>&1 &
  echo $! > app.pid

查看日志：
  tail -f /root/baiguoyuan/app.log

查看状态：
  ps aux | grep streamlit

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


⚠️ 重要提醒
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 阿里云安全组配置（必须！）
   ├─ 登录阿里云控制台
   ├─ 找到ECS实例
   ├─ 点击"安全组" → "配置规则"
   ├─ 添加入方向规则
   │  ├─ 端口：5000
   │  ├─ 协议：TCP
   │  └─ 授权对象：0.0.0.0/0
   └─ 保存

2. 服务器防火墙（必须！）
   └─ 参考"第五步：配置防火墙"

3. 数据库初始化
   └─ 首次运行会自动创建测试数据

4. 服务重启
   └─ 服务器重启后需要手动启动服务

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


❓ 常见问题
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

Q1：无法访问 http://101.201.214.42:5000

  检查清单：
  □ 服务是否运行：ps aux | grep streamlit
  □ 端口是否监听：netstat -tlnp | grep 5000
  □ 防火墙是否开放：检查服务器防火墙
  □ 安全组是否开放：检查阿里云控制台
  □ 查看日志：tail -f /root/baiguoyuan/app.log

Q2：上传文件失败

  检查：
  □ 本地路径是否正确
  □ 服务器密码是否正确
  □ 网络连接是否正常

Q3：依赖安装失败

  解决：
  pip install --upgrade pip
  pip install streamlit pandas openai schedule requests beautifulsoup4 selenium -i https://pypi.tuna.tsinghua.edu.cn/simple

Q4：端口被占用

  解决：
  lsof -i :5000
  kill -9 <PID>

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


📞 获取更多帮助
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

详细文档：
  □ 本地使用说明.md
  □ 云端部署手册.md
  □ 百果园项目说明.md

技术支持：
  □ 查看服务器日志
  □ 检查终端错误信息
  □ 参考常见问题部分

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━


✅ 部署成功标志
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

1. 浏览器能访问 http://101.201.214.42:5000
2. 页面显示"🍎 百果园舆情监测系统"
3. 能看到统计数据和信息列表
4. 手动刷新按钮可以点击

部署完成后，祝使用愉快！🎉

═══════════════════════════════════════════════════════════════
